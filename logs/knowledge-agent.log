
> knowledge-agent@1.0.0 dev
> tsx watch src/index.ts

{"level":"WARN","timestamp":"2025-12-07T14:15:09.937Z","logger":"kafkajs","message":"KafkaJS v2.0.0 switched default partitioner. To retain the same partitioning behavior as in previous versions, create the producer with the option \"createPartitioner: Partitioners.LegacyPartitioner\". See the migration guide at https://kafka.js.org/docs/migration-guide-v2.0.0#producer-new-default-partitioner for details. Silence this warning by setting the environment variable \"KAFKAJS_NO_PARTITIONER_WARNING=1\""}
[2025-12-07T14:15:09.938Z] ========================================== 
[2025-12-07T14:15:09.939Z] ðŸš€ Starting Knowledge Agent (RAG) 
[2025-12-07T14:15:09.939Z] ========================================== 
[2025-12-07T14:15:09.939Z] Connecting to PostgreSQL... 
[2025-12-07T14:15:09.989Z] âœ… Loaded 4 knowledge base entries 
[2025-12-07T14:15:09.989Z] Connecting to Kafka... 
(node:93351) TimeoutNegativeWarning: -1765116909999 is a negative number.
Timeout duration was set to 1.
(Use `node --trace-warnings ...` to show where the warning was created)
[2025-12-07T14:15:10.013Z] âœ… Knowledge Agent ready 
[2025-12-07T14:15:10.013Z] Listening for knowledge queries... 
[2025-12-07T14:15:10.013Z] ========================================== 
{"level":"INFO","timestamp":"2025-12-07T14:15:10.013Z","logger":"kafkajs","message":"[Consumer] Starting","groupId":"knowledge-agent-group"}
{"level":"INFO","timestamp":"2025-12-07T14:15:13.054Z","logger":"kafkajs","message":"[ConsumerGroup] Consumer has joined the group","groupId":"knowledge-agent-group","memberId":"knowledge-agent-84e9310c-416f-44f0-be02-94a0f9c820b1","leaderId":"knowledge-agent-84e9310c-416f-44f0-be02-94a0f9c820b1","isLeader":true,"memberAssignment":{"knowledge.queries":[0,1,2]},"groupProtocol":"RoundRobinAssigner","duration":3040}
[2025-12-07T14:17:33.648Z] ðŸ“š Processing knowledge query {"queryId":"e9a28942-5531-444c-a264-effed3ed5be0","query":"ÐœÐ¸Ð½Ð¸Ð¹ Ð°Ð¶Ð¸Ð³Ð»Ð°Ð¶ Ð±ÑƒÐ¹ Ñ…ÑƒÐ²ÑŒÑ†Ð°Ð°Ð½ÑƒÑƒÐ´Ñ‹Ð³ (KHAN-O-0000, MSE-O-0000) ÑˆÐ¸Ð½Ð¶Ð¸Ð»Ð¶, Ñ…Ó©Ñ€Ó©Ð½Ð³Ó© Ð¾Ñ€ÑƒÑƒÐ»Ð°Ð»Ñ‚Ñ‹Ð½ Ð·Ó©Ð²Ð»Ó©Ð³Ó©Ó© Ó©Ð³Ð½Ó© Ò¯Ò¯."}
[2025-12-07T14:17:33.675Z] âœ… Returned 0 results {"queryId":"e9a28942-5531-444c-a264-effed3ed5be0"}
[2025-12-07T14:19:06.118Z] ðŸ“š Processing knowledge query {"queryId":"df888b05-16d0-4323-a1ad-4c68d9224cf1","query":"APU-O-0000 Ñ…ÑƒÐ²ÑŒÑ†Ð°Ð°Ð³ ÑˆÐ¸Ð½Ð¶Ð¸Ð»Ð¶, Ñ…Ó©Ñ€Ó©Ð½Ð³Ó© Ð¾Ñ€ÑƒÑƒÐ»Ð°Ð»Ñ‚Ñ‹Ð½ Ð·Ó©Ð²Ð»Ó©Ð³Ó©Ó© Ó©Ð³Ð½Ó© Ò¯Ò¯."}
[2025-12-07T14:19:06.122Z] âœ… Returned 0 results {"queryId":"df888b05-16d0-4323-a1ad-4c68d9224cf1"}
node:events:486
      throw er; // Unhandled 'error' event
      ^

Error: Connection terminated unexpectedly
    at Connection.<anonymous> (/home/it/apps/thesis-report/backend/knowledge-agent/node_modules/pg/lib/client.js:136:73)
    at Object.onceWrapper (node:events:622:28)
    at Connection.emit (node:events:508:28)
    at Socket.<anonymous> (/home/it/apps/thesis-report/backend/knowledge-agent/node_modules/pg/lib/connection.js:62:12)
    at Socket.emit (node:events:508:28)
    at TCP.<anonymous> (node:net:346:12)
Emitted 'error' event on Client instance at:
    at Client._handleErrorEvent (/home/it/apps/thesis-report/backend/knowledge-agent/node_modules/pg/lib/client.js:350:10)
    at Connection.<anonymous> (/home/it/apps/thesis-report/backend/knowledge-agent/node_modules/pg/lib/client.js:154:16)
    at Object.onceWrapper (node:events:622:28)
    at Connection.emit (node:events:508:28)
    at Socket.<anonymous> (/home/it/apps/thesis-report/backend/knowledge-agent/node_modules/pg/lib/connection.js:62:12)
    at Socket.emit (node:events:508:28)
    at TCP.<anonymous> (node:net:346:12)

Node.js v24.11.0
