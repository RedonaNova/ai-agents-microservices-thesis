
> investment-agent@2.0.0 dev
> tsx watch src/index.ts

{"level":"WARN","timestamp":"2025-12-08T15:42:11.884Z","logger":"kafkajs","message":"KafkaJS v2.0.0 switched default partitioner. To retain the same partitioning behavior as in previous versions, create the producer with the option \"createPartitioner: Partitioners.LegacyPartitioner\". See the migration guide at https://kafka.js.org/docs/migration-guide-v2.0.0#producer-new-default-partitioner for details. Silence this warning by setting the environment variable \"KAFKAJS_NO_PARTITIONER_WARNING=1\""}
[2025-12-08T15:42:11.887Z] ========================================== 
[2025-12-08T15:42:11.887Z] üöÄ Starting Investment Agent v2.0 
[2025-12-08T15:42:11.887Z] ========================================== 
[2025-12-08T15:42:11.887Z] Connecting to PostgreSQL... 
[2025-12-08T15:42:11.931Z] Connecting to Kafka... 
(node:45039) TimeoutNegativeWarning: -1765208531957 is a negative number.
Timeout duration was set to 1.
(Use `node --trace-warnings ...` to show where the warning was created)
[2025-12-08T15:42:12.008Z] ‚úÖ Investment Agent ready 
[2025-12-08T15:42:12.008Z] Listening for investment tasks... 
[2025-12-08T15:42:12.008Z] ========================================== 
{"level":"INFO","timestamp":"2025-12-08T15:42:12.009Z","logger":"kafkajs","message":"[Consumer] Starting","groupId":"investment-agent-group"}
{"level":"INFO","timestamp":"2025-12-08T15:42:39.667Z","logger":"kafkajs","message":"[ConsumerGroup] Consumer has joined the group","groupId":"investment-agent-group","memberId":"investment-agent-108af35b-42b8-477e-876b-dc11f6e4ed60","leaderId":"investment-agent-108af35b-42b8-477e-876b-dc11f6e4ed60","isLeader":true,"memberAssignment":{"agent.tasks":[0,1,2],"execution.plans":[0,1,2]},"groupProtocol":"RoundRobinAssigner","duration":27657}
[2025-12-08T15:43:01.959Z] üì• Processing task {
  "taskId": "80963fea-0fcd-4411-ac9a-33ac4ebee3df",
  "action": "analyze_watchlist",
  "agentType": "investment"
}
[2025-12-08T15:43:01.960Z] üîç Processing request {
  "action": "analyze_watchlist",
  "symbols": [
    "APU-O-0000",
    "KHAN-O-0000"
  ],
  "hasContext": true
}
[2025-12-08T15:43:01.961Z] üîç Looking up MSE data for symbols {
  "symbolList": [
    "APU-O-0000",
    "KHAN-O-0000"
  ]
}
[2025-12-08T15:43:01.994Z] üìä Fetched MSE data {
  "count": 2,
  "symbols": [
    "APU-O-0000",
    "KHAN-O-0000"
  ]
}
[2025-12-08T15:43:14.584Z] ‚úÖ Response saved to database {
  "requestId": "1d52e572-e8a8-4b54-8154-784d84beb97e"
}
[2025-12-08T15:43:14.584Z] ‚úÖ Task completed {
  "taskId": "80963fea-0fcd-4411-ac9a-33ac4ebee3df",
  "duration": 12625
}
11:43:45 PM [tsx] change in ./src/index.ts Restarting...
[2025-12-08T15:43:45.652Z] Shutting down... 
{"level":"INFO","timestamp":"2025-12-08T15:43:49.850Z","logger":"kafkajs","message":"[Runner] consumer not running, exiting","groupId":"investment-agent-group","memberId":"investment-agent-108af35b-42b8-477e-876b-dc11f6e4ed60"}
{"level":"INFO","timestamp":"2025-12-08T15:43:49.868Z","logger":"kafkajs","message":"[Consumer] Stopped","groupId":"investment-agent-group"}
11:43:50 PM [tsx] Process didn't exit in 5s. Force killing...
c{"level":"WARN","timestamp":"2025-12-08T15:43:51.102Z","logger":"kafkajs","message":"KafkaJS v2.0.0 switched default partitioner. To retain the same partitioning behavior as in previous versions, create the producer with the option \"createPartitioner: Partitioners.LegacyPartitioner\". See the migration guide at https://kafka.js.org/docs/migration-guide-v2.0.0#producer-new-default-partitioner for details. Silence this warning by setting the environment variable \"KAFKAJS_NO_PARTITIONER_WARNING=1\""}
[2025-12-08T15:43:51.103Z] ========================================== 
[2025-12-08T15:43:51.103Z] üöÄ Starting Investment Agent v2.0 
[2025-12-08T15:43:51.103Z] ========================================== 
[2025-12-08T15:43:51.103Z] Connecting to PostgreSQL... 
[2025-12-08T15:43:51.125Z] Connecting to Kafka... 
(node:45624) TimeoutNegativeWarning: -1765208631133 is a negative number.
Timeout duration was set to 1.
(Use `node --trace-warnings ...` to show where the warning was created)
[2025-12-08T15:43:51.141Z] ‚úÖ Investment Agent ready 
[2025-12-08T15:43:51.142Z] Listening for investment tasks... 
[2025-12-08T15:43:51.142Z] ========================================== 
{"level":"INFO","timestamp":"2025-12-08T15:43:51.142Z","logger":"kafkajs","message":"[Consumer] Starting","groupId":"investment-agent-group"}
{"level":"INFO","timestamp":"2025-12-08T15:43:54.165Z","logger":"kafkajs","message":"[ConsumerGroup] Consumer has joined the group","groupId":"investment-agent-group","memberId":"investment-agent-60540833-b6b7-412d-91d3-c1437a335648","leaderId":"investment-agent-60540833-b6b7-412d-91d3-c1437a335648","isLeader":true,"memberAssignment":{"agent.tasks":[0,1,2],"execution.plans":[0,1,2]},"groupProtocol":"RoundRobinAssigner","duration":3022}
node:events:486
      throw er; // Unhandled 'error' event
      ^

error: terminating connection due to administrator command
    at Parser.parseErrorMessage (/home/it/apps/thesis-report/backend/investment-agent/node_modules/pg-protocol/src/parser.ts:369:69)
    at Parser.handlePacket (/home/it/apps/thesis-report/backend/investment-agent/node_modules/pg-protocol/src/parser.ts:187:21)
    at Parser.parse (/home/it/apps/thesis-report/backend/investment-agent/node_modules/pg-protocol/src/parser.ts:102:30)
    at Socket.<anonymous> (/home/it/apps/thesis-report/backend/investment-agent/node_modules/pg-protocol/src/index.ts:7:48)
    at Socket.emit (node:events:508:28)
    at addChunk (node:internal/streams/readable:559:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)
    at Readable.push (node:internal/streams/readable:390:5)
    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)
Emitted 'error' event on Client instance at:
    at Client._handleErrorEvent (/home/it/apps/thesis-report/backend/investment-agent/node_modules/pg/lib/client.js:350:10)
    at Client._handleErrorMessage (/home/it/apps/thesis-report/backend/investment-agent/node_modules/pg/lib/client.js:361:12)
    at Connection.emit (node:events:508:28)
    at /home/it/apps/thesis-report/backend/investment-agent/node_modules/pg/lib/connection.js:116:12
    at Parser.parse (/home/it/apps/thesis-report/backend/investment-agent/node_modules/pg-protocol/src/parser.ts:103:9)
    at Socket.<anonymous> (/home/it/apps/thesis-report/backend/investment-agent/node_modules/pg-protocol/src/index.ts:7:48)
    at Socket.emit (node:events:508:28)
    at addChunk (node:internal/streams/readable:559:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)
    at Readable.push (node:internal/streams/readable:390:5) {
  length: 116,
  severity: 'FATAL',
  code: '57P01',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'postgres.c',
  line: '3286',
  routine: 'ProcessInterrupts'
}

Node.js v24.11.0
