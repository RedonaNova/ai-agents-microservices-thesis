
> api-gateway@1.0.0 dev
> tsx watch src/index.ts

[32minfo[39m: âœ… Email service configured {"service":"api-gateway","timestamp":"2025-12-04T06:45:29.124Z"}
[32minfo[39m: âœ… Gemini AI configured for email generation {"service":"api-gateway","timestamp":"2025-12-04T06:45:29.127Z"}
[32minfo[39m: Starting API Gateway... {"env":"development","port":3001,"service":"api-gateway","timestamp":"2025-12-04T06:45:29.150Z"}
[32minfo[39m: âœ… PostgreSQL connected successfully {"service":"api-gateway","timestamp":"2025-12-04T06:45:29.173Z"}
{"level":"WARN","timestamp":"2025-12-04T06:45:29.174Z","logger":"kafkajs","message":"KafkaJS v2.0.0 switched default partitioner. To retain the same partitioning behavior as in previous versions, create the producer with the option \"createPartitioner: Partitioners.LegacyPartitioner\". See the migration guide at https://kafka.js.org/docs/migration-guide-v2.0.0#producer-new-default-partitioner for details. Silence this warning by setting the environment variable \"KAFKAJS_NO_PARTITIONER_WARNING=1\""}
(node:31088) TimeoutNegativeWarning: -1764830729185 is a negative number.
Timeout duration was set to 1.
(Use `node --trace-warnings ...` to show where the warning was created)
[32minfo[39m: Kafka producer connected {"service":"api-gateway","timestamp":"2025-12-04T06:45:29.186Z"}
[32minfo[39m: API Gateway listening on port 3001 {"service":"api-gateway","timestamp":"2025-12-04T06:45:29.188Z"}
[32minfo[39m: CORS enabled for: http://localhost:3000 {"service":"api-gateway","timestamp":"2025-12-04T06:45:29.188Z"}
[32minfo[39m: Kafka broker: localhost:9092 {"service":"api-gateway","timestamp":"2025-12-04T06:45:29.188Z"}
[32minfo[39m: API Gateway is ready! {"service":"api-gateway","timestamp":"2025-12-04T06:45:29.188Z"}
[32minfo[39m: GET /health {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:45:29.858Z","userAgent":"curl/8.5.0"}
[32minfo[39m: POST /api/agent/query {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:45:56.027Z","userAgent":"PostmanRuntime/7.49.1"}
[32minfo[39m: Event sent to user.requests {"key":"1983c567-826b-46fe-a378-d354f439991a","service":"api-gateway","timestamp":"2025-12-04T06:45:56.083Z"}
[32minfo[39m: User query sent to orchestrator {"requestId":"1983c567-826b-46fe-a378-d354f439991a","service":"api-gateway","timestamp":"2025-12-04T06:45:56.083Z","userId":"2"}
[32minfo[39m: GET /api/agent/response/46fe {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:46:02.448Z","userAgent":"PostmanRuntime/7.49.1"}
[31merror[39m: Database query error: {"error":{"code":"22P02","file":"uuid.c","length":136,"line":"133","name":"error","routine":"string_to_uuid","severity":"ERROR","where":"unnamed portal parameter $1 = '...'"},"service":"api-gateway","text":"SELECT request_id, agent_type, query, response, status, processing_time_ms, created_at\n       FROM agent_responses_cache\n       WHERE request_id = $1","timestamp":"2025-12-04T06:46:02.473Z"}
[31merror[39m: Get response error {"error":{"code":"22P02","file":"uuid.c","length":136,"line":"133","name":"error","routine":"string_to_uuid","severity":"ERROR","where":"unnamed portal parameter $1 = '...'"},"service":"api-gateway","timestamp":"2025-12-04T06:46:02.473Z"}
[32minfo[39m: GET /api/agent/response/1983c567-826b-46fe-a378-d354f439991a {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:46:12.864Z","userAgent":"PostmanRuntime/7.49.1"}
[32minfo[39m: POST /api/agent/analyze-watchlist {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:47:02.130Z","userAgent":"PostmanRuntime/7.49.1"}
[32minfo[39m: Event sent to user.requests {"key":"e14d552d-8960-445b-85a2-7c2d1c324794","service":"api-gateway","timestamp":"2025-12-04T06:47:02.157Z"}
[32minfo[39m: Watchlist analysis request sent {"requestId":"e14d552d-8960-445b-85a2-7c2d1c324794","service":"api-gateway","symbols":["SUL-O-0000","TEX-O-0000","TTL-O-0000"],"timestamp":"2025-12-04T06:47:02.157Z","userId":"2"}
[32minfo[39m: GET /api/agent/response/e14d552d-8960-445b-85a2-7c2d1c324794 {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:47:07.396Z","userAgent":"PostmanRuntime/7.49.1"}
[32minfo[39m: GET /api/agent/response/e14d552d-8960-445b-85a2-7c2d1c324794 {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:47:08.787Z","userAgent":"PostmanRuntime/7.49.1"}
[32minfo[39m: GET /api/agent/response/e14d552d-8960-445b-85a2-7c2d1c324794 {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:47:09.567Z","userAgent":"PostmanRuntime/7.49.1"}
[32minfo[39m: GET /api/agent/response/e14d552d-8960-445b-85a2-7c2d1c324794 {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:47:10.490Z","userAgent":"PostmanRuntime/7.49.1"}
[32minfo[39m: GET /api/agent/response/e14d552d-8960-445b-85a2-7c2d1c324794 {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:47:11.319Z","userAgent":"PostmanRuntime/7.49.1"}
[32minfo[39m: GET /api/agent/response/e14d552d-8960-445b-85a2-7c2d1c324794 {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:47:12.280Z","userAgent":"PostmanRuntime/7.49.1"}
[32minfo[39m: GET /api/agent/response/e14d552d-8960-445b-85a2-7c2d1c324794 {"ip":"::1","service":"api-gateway","timestamp":"2025-12-04T06:47:15.950Z","userAgent":"PostmanRuntime/7.49.1"}
