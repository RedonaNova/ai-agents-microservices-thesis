
> orchestrator-agent@1.0.0 dev
> tsx watch src/index.ts

{"level":"WARN","timestamp":"2025-11-18T02:43:44.401Z","logger":"kafkajs","message":"KafkaJS v2.0.0 switched default partitioner. To retain the same partitioning behavior as in previous versions, create the producer with the option \"createPartitioner: Partitioners.LegacyPartitioner\". See the migration guide at https://kafka.js.org/docs/migration-guide-v2.0.0#producer-new-default-partitioner for details. Silence this warning by setting the environment variable \"KAFKAJS_NO_PARTITIONER_WARNING=1\""}
[32minfo[39m: ========================================== {"service":"orchestrator-agent","timestamp":"2025-11-18T02:43:44.527Z"}
[32minfo[39m: ðŸš€ Starting Orchestrator Agent (v2.0) {"service":"orchestrator-agent","timestamp":"2025-11-18T02:43:44.528Z"}
[32minfo[39m: ========================================== {"service":"orchestrator-agent","timestamp":"2025-11-18T02:43:44.528Z"}
[32minfo[39m: Connecting to Kafka... {"service":"orchestrator-agent","timestamp":"2025-11-18T02:43:44.528Z"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.545Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.546Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":0,"retryTime":115}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.546Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.547Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":0,"retryTime":89}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.639Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.640Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":1,"retryTime":160}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.662Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.663Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":1,"retryTime":216}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.802Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.802Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":2,"retryTime":352}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.885Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:44.886Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":2,"retryTime":486}
{"level":"ERROR","timestamp":"2025-11-18T02:43:45.155Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:45.156Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":3,"retryTime":644}
{"level":"ERROR","timestamp":"2025-11-18T02:43:45.375Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:45.375Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":3,"retryTime":1020}
{"level":"ERROR","timestamp":"2025-11-18T02:43:45.802Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:45.802Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":4,"retryTime":1074}
{"level":"ERROR","timestamp":"2025-11-18T02:43:46.399Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:46.399Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":4,"retryTime":2334}
{"level":"ERROR","timestamp":"2025-11-18T02:43:46.878Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:46.879Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":5,"retryTime":2500}
{"level":"ERROR","timestamp":"2025-11-18T02:43:48.735Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:48.735Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":5,"retryTime":4200}
{"level":"ERROR","timestamp":"2025-11-18T02:43:49.384Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:49.384Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":6,"retryTime":4772}
{"level":"ERROR","timestamp":"2025-11-18T02:43:52.941Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:52.941Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":6,"retryTime":7624}
{"level":"ERROR","timestamp":"2025-11-18T02:43:54.161Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:43:54.161Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":7,"retryTime":10054}
{"level":"ERROR","timestamp":"2025-11-18T02:44:00.567Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:44:00.568Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":7,"retryTime":17974}
{"level":"ERROR","timestamp":"2025-11-18T02:44:04.216Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-18T02:44:04.217Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":8,"retryTime":18530}
[31merror[39m: Failed to connect to Kafka {"error":"Connection error: connect ECONNREFUSED 127.0.0.1:9092","service":"orchestrator-agent","timestamp":"2025-11-18T02:44:04.218Z"}
[31merror[39m: Failed to start orchestrator agent {"error":"Connection error: connect ECONNREFUSED 127.0.0.1:9092","service":"orchestrator-agent","stack":"KafkaJSNonRetriableError\n  Caused by: KafkaJSConnectionError: Connection error: connect ECONNREFUSED 127.0.0.1:9092\n    at Socket.onError (/home/it/apps/thesis-report/backend/orchestrator-agent/node_modules/kafkajs/src/network/connection.js:210:23)\n    at Socket.emit (node:events:508:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)","timestamp":"2025-11-18T02:44:04.218Z"}
