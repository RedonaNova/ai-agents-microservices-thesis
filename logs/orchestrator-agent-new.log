
> orchestrator-agent@1.0.0 dev
> tsx watch src/index.ts

{"level":"WARN","timestamp":"2025-11-10T16:50:54.573Z","logger":"kafkajs","message":"KafkaJS v2.0.0 switched default partitioner. To retain the same partitioning behavior as in previous versions, create the producer with the option \"createPartitioner: Partitioners.LegacyPartitioner\". See the migration guide at https://kafka.js.org/docs/migration-guide-v2.0.0#producer-new-default-partitioner for details. Silence this warning by setting the environment variable \"KAFKAJS_NO_PARTITIONER_WARNING=1\""}
[32minfo[39m: ========================================== {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.622Z"}
[32minfo[39m: ðŸš€ Starting Orchestrator Agent (v2.0) {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.624Z"}
[32minfo[39m: ========================================== {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.625Z"}
[32minfo[39m: Connecting to Kafka... {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.625Z"}
(node:82481) TimeoutNegativeWarning: -1762793454655 is a negative number.
Timeout duration was set to 1.
(Use `node --trace-warnings ...` to show where the warning was created)
[32minfo[39m: âœ… Connected to Kafka {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.658Z"}
[32minfo[39m: Subscribing to topics... {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.658Z"}
[32minfo[39m: âœ… Subscribed to topics: user.requests, knowledge.results {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.673Z"}
[32minfo[39m: ðŸ“‹ Configuration: {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.673Z"}
[32minfo[39m:   - Input Topic: user.requests {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.674Z"}
[32minfo[39m:   - Output Topics: agent.tasks, planning.tasks, knowledge.queries {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.674Z"}
[32minfo[39m:   - Monitoring: monitoring.events {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.675Z"}
[32minfo[39m:  {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.675Z"}
[32minfo[39m: Starting message consumption... {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:54.675Z"}
{"level":"INFO","timestamp":"2025-11-10T16:50:54.676Z","logger":"kafkajs","message":"[Consumer] Starting","groupId":"orchestrator-group"}
{"level":"INFO","timestamp":"2025-11-10T16:50:57.558Z","logger":"kafkajs","message":"[ConsumerGroup] Consumer has joined the group","groupId":"orchestrator-group","memberId":"orchestrator-agent-878ab2f3-ee4d-4d8c-a940-966cd229214f","leaderId":"orchestrator-agent-f1c4e181-9ae8-4978-8444-24cca5799d1c","isLeader":false,"memberAssignment":{"user.requests":[0,1],"knowledge.results":[2]},"groupProtocol":"RoundRobinAssigner","duration":2878}
[32minfo[39m: âœ… Started consuming messages {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:57.560Z"}
[32minfo[39m: ========================================== {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:57.560Z"}
[32minfo[39m: âœ… Orchestrator Agent is running! {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:57.560Z"}
[32minfo[39m: ========================================== {"service":"orchestrator-agent","timestamp":"2025-11-10T16:50:57.560Z"}
12:55:01 AM [tsx] change in ./src/kafka-client.ts Restarting...
[32minfo[39m: SIGTERM received, shutting down gracefully... {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:01.509Z"}
[32minfo[39m: Shutting down orchestrator agent... {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:01.509Z"}
[32minfo[39m: Total requests processed: 0 {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:01.510Z"}
{"level":"INFO","timestamp":"2025-11-10T16:55:03.004Z","logger":"kafkajs","message":"[Runner] consumer not running, exiting","groupId":"orchestrator-group","memberId":"orchestrator-agent-878ab2f3-ee4d-4d8c-a940-966cd229214f"}
{"level":"INFO","timestamp":"2025-11-10T16:55:03.010Z","logger":"kafkajs","message":"[Consumer] Stopped","groupId":"orchestrator-group"}
[32minfo[39m: Disconnected from Kafka {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.010Z"}
[32minfo[39m: Orchestrator agent stopped {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.010Z"}
c{"level":"WARN","timestamp":"2025-11-10T16:55:03.431Z","logger":"kafkajs","message":"KafkaJS v2.0.0 switched default partitioner. To retain the same partitioning behavior as in previous versions, create the producer with the option \"createPartitioner: Partitioners.LegacyPartitioner\". See the migration guide at https://kafka.js.org/docs/migration-guide-v2.0.0#producer-new-default-partitioner for details. Silence this warning by setting the environment variable \"KAFKAJS_NO_PARTITIONER_WARNING=1\""}
[32minfo[39m: ========================================== {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.466Z"}
[32minfo[39m: ðŸš€ Starting Orchestrator Agent (v2.0) {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.468Z"}
[32minfo[39m: ========================================== {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.469Z"}
[32minfo[39m: Connecting to Kafka... {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.469Z"}
(node:84871) TimeoutNegativeWarning: -1762793703495 is a negative number.
Timeout duration was set to 1.
(Use `node --trace-warnings ...` to show where the warning was created)
[32minfo[39m: âœ… Connected to Kafka {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.496Z"}
[32minfo[39m: Subscribing to topics... {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.497Z"}
[32minfo[39m: âœ… Subscribed to topics: user.requests, knowledge.results {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.504Z"}
[32minfo[39m: ðŸ“‹ Configuration: {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.504Z"}
[32minfo[39m:   - Input Topic: user.requests {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.504Z"}
[32minfo[39m:   - Output Topics: agent.tasks, planning.tasks, knowledge.queries {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.504Z"}
[32minfo[39m:   - Monitoring: monitoring.events {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.505Z"}
[32minfo[39m:  {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.505Z"}
[32minfo[39m: Starting message consumption... {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.505Z"}
{"level":"INFO","timestamp":"2025-11-10T16:55:03.505Z","logger":"kafkajs","message":"[Consumer] Starting","groupId":"orchestrator-group"}
{"level":"INFO","timestamp":"2025-11-10T16:55:03.675Z","logger":"kafkajs","message":"[ConsumerGroup] Consumer has joined the group","groupId":"orchestrator-group","memberId":"orchestrator-agent-50685353-afe6-45d6-94a6-2d78d3276072","leaderId":"orchestrator-agent-50685353-afe6-45d6-94a6-2d78d3276072","isLeader":true,"memberAssignment":{"user.requests":[0,1,2],"knowledge.results":[0,1,2]},"groupProtocol":"RoundRobinAssigner","duration":169}
[32minfo[39m: âœ… Started consuming messages {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.677Z"}
[32minfo[39m: ========================================== {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.677Z"}
[32minfo[39m: âœ… Orchestrator Agent is running! {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.677Z"}
[32minfo[39m: ========================================== {"service":"orchestrator-agent","timestamp":"2025-11-10T16:55:03.677Z"}
{"level":"ERROR","timestamp":"2025-11-10T16:55:08.713Z","logger":"kafkajs","message":"[Connection] Response Heartbeat(key: 12, version: 3)","broker":"localhost:9092","clientId":"orchestrator-agent","error":"The group is rebalancing, so a rejoin is needed","correlationId":9,"size":10}
{"level":"ERROR","timestamp":"2025-11-10T16:55:08.715Z","logger":"kafkajs","message":"[Connection] Response Heartbeat(key: 12, version: 3)","broker":"localhost:9092","clientId":"orchestrator-agent","error":"The group is rebalancing, so a rejoin is needed","correlationId":10,"size":10}
{"level":"ERROR","timestamp":"2025-11-10T16:55:08.717Z","logger":"kafkajs","message":"[Connection] Response Heartbeat(key: 12, version: 3)","broker":"localhost:9092","clientId":"orchestrator-agent","error":"The group is rebalancing, so a rejoin is needed","correlationId":11,"size":10}
{"level":"ERROR","timestamp":"2025-11-10T16:55:08.718Z","logger":"kafkajs","message":"[Connection] Response Heartbeat(key: 12, version: 3)","broker":"localhost:9092","clientId":"orchestrator-agent","error":"The group is rebalancing, so a rejoin is needed","correlationId":12,"size":10}
{"level":"ERROR","timestamp":"2025-11-10T16:55:08.719Z","logger":"kafkajs","message":"[Connection] Response Heartbeat(key: 12, version: 3)","broker":"localhost:9092","clientId":"orchestrator-agent","error":"The group is rebalancing, so a rejoin is needed","correlationId":13,"size":10}
{"level":"ERROR","timestamp":"2025-11-10T16:55:08.721Z","logger":"kafkajs","message":"[Connection] Response Heartbeat(key: 12, version: 3)","broker":"localhost:9092","clientId":"orchestrator-agent","error":"The group is rebalancing, so a rejoin is needed","correlationId":14,"size":10}
{"level":"WARN","timestamp":"2025-11-10T16:55:08.722Z","logger":"kafkajs","message":"[Runner] The group is rebalancing, re-joining","groupId":"orchestrator-group","memberId":"orchestrator-agent-50685353-afe6-45d6-94a6-2d78d3276072","error":"The group is rebalancing, so a rejoin is needed"}
{"level":"INFO","timestamp":"2025-11-10T16:55:08.732Z","logger":"kafkajs","message":"[ConsumerGroup] Consumer has joined the group","groupId":"orchestrator-group","memberId":"orchestrator-agent-50685353-afe6-45d6-94a6-2d78d3276072","leaderId":"orchestrator-agent-50685353-afe6-45d6-94a6-2d78d3276072","isLeader":true,"memberAssignment":{"user.requests":[0,1],"knowledge.results":[2]},"groupProtocol":"RoundRobinAssigner","duration":10}
{"level":"ERROR","timestamp":"2025-11-10T17:32:10.276Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:10.281Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":0,"retryTime":102}
{"level":"ERROR","timestamp":"2025-11-10T17:32:10.412Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:10.414Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":1,"retryTime":184}
{"level":"ERROR","timestamp":"2025-11-10T17:32:10.602Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:10.602Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":2,"retryTime":340}
{"level":"ERROR","timestamp":"2025-11-10T17:32:10.946Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:10.946Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":3,"retryTime":664}
{"level":"ERROR","timestamp":"2025-11-10T17:32:11.613Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:11.614Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":4,"retryTime":1224}
{"level":"ERROR","timestamp":"2025-11-10T17:32:12.844Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:12.845Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":5,"retryTime":1970}
{"level":"ERROR","timestamp":"2025-11-10T17:32:14.818Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:14.819Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":6,"retryTime":3744}
{"level":"ERROR","timestamp":"2025-11-10T17:32:18.569Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:18.570Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":7,"retryTime":8224}
{"level":"ERROR","timestamp":"2025-11-10T17:32:26.804Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:26.804Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":8,"retryTime":15780}
{"level":"ERROR","timestamp":"2025-11-10T17:32:26.820Z","logger":"kafkajs","message":"[Consumer] Crash: KafkaJSNonRetriableError: Connection error: connect ECONNREFUSED 127.0.0.1:9092","groupId":"orchestrator-group","stack":"KafkaJSNonRetriableError: Connection error: connect ECONNREFUSED 127.0.0.1:9092\n    at /home/it/apps/thesis-report/backend/orchestrator-agent/node_modules/kafkajs/src/retry/index.js:55:18\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:26.840Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"INFO","timestamp":"2025-11-10T17:32:26.841Z","logger":"kafkajs","message":"[Consumer] Stopped","groupId":"orchestrator-group"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:26.841Z","logger":"kafkajs","message":"[Consumer] Restarting the consumer in 100ms","retryTime":100,"groupId":"orchestrator-group"}
{"level":"INFO","timestamp":"2025-11-10T17:32:26.943Z","logger":"kafkajs","message":"[Consumer] Starting","groupId":"orchestrator-group"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:26.946Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:26.946Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":0,"retryTime":119}
{"level":"ERROR","timestamp":"2025-11-10T17:32:27.067Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:27.068Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":1,"retryTime":212}
{"level":"ERROR","timestamp":"2025-11-10T17:32:27.282Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:27.283Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":2,"retryTime":420}
{"level":"ERROR","timestamp":"2025-11-10T17:32:27.705Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:27.706Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":3,"retryTime":824}
{"level":"ERROR","timestamp":"2025-11-10T17:32:28.533Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:28.534Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":4,"retryTime":1566}
{"level":"ERROR","timestamp":"2025-11-10T17:32:30.103Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:30.103Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":5,"retryTime":2530}
{"level":"ERROR","timestamp":"2025-11-10T17:32:32.652Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:32.653Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":6,"retryTime":6022}
{"level":"ERROR","timestamp":"2025-11-10T17:32:38.681Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:38.682Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":7,"retryTime":13456}
{"level":"ERROR","timestamp":"2025-11-10T17:32:52.149Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:52.149Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":8,"retryTime":29224}
{"level":"ERROR","timestamp":"2025-11-10T17:32:52.149Z","logger":"kafkajs","message":"[Consumer] Crash: KafkaJSNumberOfRetriesExceeded: Connection error: connect ECONNREFUSED 127.0.0.1:9092","groupId":"orchestrator-group","retryCount":8,"stack":"KafkaJSNonRetriableError\n  Caused by: KafkaJSConnectionError: Connection error: connect ECONNREFUSED 127.0.0.1:9092\n    at Socket.onError (/home/it/apps/thesis-report/backend/orchestrator-agent/node_modules/kafkajs/src/network/connection.js:210:23)\n    at Socket.emit (node:events:508:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)"}
{"level":"INFO","timestamp":"2025-11-10T17:32:52.149Z","logger":"kafkajs","message":"[Consumer] Stopped","groupId":"orchestrator-group"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:52.150Z","logger":"kafkajs","message":"[Consumer] Restarting the consumer in 29224ms","retryCount":8,"retryTime":29224,"groupId":"orchestrator-group"}
PConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:30.580Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":0,"retryTime":81}
{"level":"ERROR","timestamp":"2025-11-10T17:32:30.664Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:30.664Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":1,"retryTime":186}
{"level":"ERROR","timestamp":"2025-11-10T17:32:30.853Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:30.853Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":2,"retryTime":320}
{"level":"ERROR","timestamp":"2025-11-10T17:32:31.176Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:31.177Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":3,"retryTime":672}
{"level":"ERROR","timestamp":"2025-11-10T17:32:31.851Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:31.852Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":4,"retryTime":1452}
{"level":"ERROR","timestamp":"2025-11-10T17:32:33.306Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:33.307Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":5,"retryTime":2648}
{"level":"ERROR","timestamp":"2025-11-10T17:32:35.957Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:35.958Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":6,"retryTime":6264}
{"level":"ERROR","timestamp":"2025-11-10T17:32:42.228Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:42.229Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":7,"retryTime":10346}
{"level":"ERROR","timestamp":"2025-11-10T17:32:52.585Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"orchestrator-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:52.586Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":8,"retryTime":24826}
{"level":"ERROR","timestamp":"2025-11-10T17:32:52.586Z","logger":"kafkajs","message":"[Consumer] Crash: KafkaJSNumberOfRetriesExceeded: Connection error: connect ECONNREFUSED 127.0.0.1:9092","groupId":"orchestrator-group","retryCount":8,"stack":"KafkaJSNonRetriableError\n  Caused by: KafkaJSConnectionError: Connection error: connect ECONNREFUSED 127.0.0.1:9092\n    at Socket.onError (/home/it/apps/thesis-report/backend/orchestrator-agent/node_modules/kafkajs/src/network/connection.js:210:23)\n    at Socket.emit (node:events:508:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)"}
{"level":"INFO","timestamp":"2025-11-10T17:32:52.586Z","logger":"kafkajs","message":"[Consumer] Stopped","groupId":"orchestrator-group"}
{"level":"ERROR","timestamp":"2025-11-10T17:32:52.586Z","logger":"kafkajs","message":"[Consumer] Restarting the consumer in 24826ms","retryCount":8,"retryTime":24826,"groupId":"orchestrator-group"}
