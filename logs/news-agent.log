
> news-agent@2.0.0 dev
> tsx watch src/index.ts

{"level":"WARN","timestamp":"2025-12-07T14:15:12.962Z","logger":"kafkajs","message":"KafkaJS v2.0.0 switched default partitioner. To retain the same partitioning behavior as in previous versions, create the producer with the option \"createPartitioner: Partitioners.LegacyPartitioner\". See the migration guide at https://kafka.js.org/docs/migration-guide-v2.0.0#producer-new-default-partitioner for details. Silence this warning by setting the environment variable \"KAFKAJS_NO_PARTITIONER_WARNING=1\""}
[2025-12-07T14:15:12.965Z] ========================================== 
[2025-12-07T14:15:12.965Z] ðŸ“° Starting News Agent v2.0 
[2025-12-07T14:15:12.965Z] ========================================== 
[2025-12-07T14:15:12.966Z] Connecting to Kafka... 
(node:93429) TimeoutNegativeWarning: -1765116913012 is a negative number.
Timeout duration was set to 1.
(Use `node --trace-warnings ...` to show where the warning was created)
[2025-12-07T14:15:13.028Z] âœ… News Agent ready 
[2025-12-07T14:15:13.028Z] Listening for news tasks... 
[2025-12-07T14:15:13.028Z] ========================================== 
{"level":"INFO","timestamp":"2025-12-07T14:15:13.029Z","logger":"kafkajs","message":"[Consumer] Starting","groupId":"news-agent-group"}
{"level":"INFO","timestamp":"2025-12-07T14:15:14.636Z","logger":"kafkajs","message":"[ConsumerGroup] Consumer has joined the group","groupId":"news-agent-group","memberId":"news-agent-d5602f99-ab94-4671-b8bc-5431f71a97bf","leaderId":"news-agent-cdebd3db-b506-432a-9d76-8aba35a64540","isLeader":false,"memberAssignment":{},"groupProtocol":"RoundRobinAssigner","duration":1606}
{"level":"ERROR","timestamp":"2025-12-07T14:25:17.746Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:17.747Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:17.748Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":0,"retryTime":332}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.082Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.082Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":1,"retryTime":594}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.680Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.680Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":2,"retryTime":1364}
{"level":"ERROR","timestamp":"2025-12-07T14:25:20.048Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:20.049Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":3,"retryTime":2264}
{"level":"ERROR","timestamp":"2025-12-07T14:25:22.320Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:22.321Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":4,"retryTime":3954}
{"level":"ERROR","timestamp":"2025-12-07T14:25:26.282Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:26.282Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":5,"retryTime":7692}
{"level":"ERROR","timestamp":"2025-12-07T14:25:26.283Z","logger":"kafkajs","message":"[Consumer] Crash: KafkaJSNonRetriableError: Connection error: connect ECONNREFUSED 127.0.0.1:9092","groupId":"news-agent-group","stack":"KafkaJSNonRetriableError: Connection error: connect ECONNREFUSED 127.0.0.1:9092\n    at /home/it/apps/thesis-report/backend/news-agent/node_modules/kafkajs/src/retry/index.js:55:18\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:26.290Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"INFO","timestamp":"2025-12-07T14:25:26.290Z","logger":"kafkajs","message":"[Consumer] Stopped","groupId":"news-agent-group"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:26.291Z","logger":"kafkajs","message":"[Consumer] Restarting the consumer in 300ms","retryTime":300,"groupId":"news-agent-group"}
{"level":"INFO","timestamp":"2025-12-07T14:25:26.592Z","logger":"kafkajs","message":"[Consumer] Starting","groupId":"news-agent-group"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:26.593Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:26.594Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":0,"retryTime":315}
{"level":"ERROR","timestamp":"2025-12-07T14:25:26.914Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:26.914Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":1,"retryTime":676}
{"level":"ERROR","timestamp":"2025-12-07T14:25:27.596Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:27.596Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":2,"retryTime":1176}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.773Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.774Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":3,"retryTime":2088}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       {"level":"ERROR","timestamp":"2025-12-07T14:15:14.546Z","logger":"kafkajs","message":"[Connection] Response Heartbeat(key: 12, version: 3)","broker":"localhost:9092","clientId":"news-agent","error":"The group is rebalancing, so a rejoin is needed","correlationId":18,"size":10}
{"level":"WARN","timestamp":"2025-12-07T14:15:14.547Z","logger":"kafkajs","message":"[Runner] The group is rebalancing, re-joining","groupId":"news-agent-group","memberId":"news-agent-b5ddd9ee-af5b-4454-854c-c11bf676f4f2","error":"The group is rebalancing, so a rejoin is needed"}
{"level":"INFO","timestamp":"2025-12-07T14:15:14.631Z","logger":"kafkajs","message":"[ConsumerGroup] Consumer has joined the group","groupId":"news-agent-group","memberId":"news-agent-b5ddd9ee-af5b-4454-854c-c11bf676f4f2","leaderId":"news-agent-cdebd3db-b506-432a-9d76-8aba35a64540","isLeader":false,"memberAssignment":{"agent.tasks":[0]},"groupProtocol":"RoundRobinAssigner","duration":84}
{"level":"ERROR","timestamp":"2025-12-07T14:25:17.473Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:17.773Z","logger":"kafkajs","message":"[Consumer] Crash: KafkaJSNoBrokerAvailableError: No broker available","groupId":"news-agent-group","stack":"KafkaJSNoBrokerAvailableError: No broker available\n    at createFetchers (/home/it/apps/thesis-report/backend/news-agent/node_modules/kafkajs/src/consumer/fetchManager.js:38:13)\n    at Object.start (/home/it/apps/thesis-report/backend/news-agent/node_modules/kafkajs/src/consumer/fetchManager.js:71:18)\n    at /home/it/apps/thesis-report/backend/news-agent/node_modules/kafkajs/src/consumer/runner.js:113:33\n    at retry (/home/it/apps/thesis-report/backend/news-agent/node_modules/kafkajs/src/retry/index.js:43:5)\n    at Timeout._onTimeout (/home/it/apps/thesis-report/backend/news-agent/node_modules/kafkajs/src/retry/index.js:40:24)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:17.774Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"INFO","timestamp":"2025-12-07T14:25:17.775Z","logger":"kafkajs","message":"[Consumer] Stopped","groupId":"news-agent-group"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:17.775Z","logger":"kafkajs","message":"[Consumer] Restarting the consumer in 300ms","retryTime":300,"groupId":"news-agent-group"}
{"level":"INFO","timestamp":"2025-12-07T14:25:18.078Z","logger":"kafkajs","message":"[Consumer] Starting","groupId":"news-agent-group"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.080Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.080Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":0,"retryTime":254}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.338Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.339Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":1,"retryTime":558}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.903Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.904Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":2,"retryTime":1310}
{"level":"ERROR","timestamp":"2025-12-07T14:25:20.219Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:20.219Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":3,"retryTime":3080}
{"level":"ERROR","timestamp":"2025-12-07T14:25:23.318Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:23.318Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":4,"retryTime":4932}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.266Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.267Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":5,"retryTime":11126}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.267Z","logger":"kafkajs","message":"[Consumer] Crash: KafkaJSNumberOfRetriesExceeded: Connection error: connect ECONNREFUSED 127.0.0.1:9092","groupId":"news-agent-group","retryCount":5,"stack":"KafkaJSNonRetriableError\n  Caused by: KafkaJSConnectionError: Connection error: connect ECONNREFUSED 127.0.0.1:9092\n    at Socket.onError (/home/it/apps/thesis-report/backend/news-agent/node_modules/kafkajs/src/network/connection.js:210:23)\n    at Socket.emit (node:events:508:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)"}
{"level":"INFO","timestamp":"2025-12-07T14:25:28.267Z","logger":"kafkajs","message":"[Consumer] Stopped","groupId":"news-agent-group"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.267Z","logger":"kafkajs","message":"[Consumer] Restarting the consumer in 11126ms","retryCount":5,"retryTime":11126,"groupId":"news-agent-group"}
timestamp":"2025-12-07T14:25:18.122Z","logger":"kafkajs","message":"[Consumer] Starting","groupId":"news-agent-group"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.125Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.125Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":0,"retryTime":350}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.477Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.478Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":1,"retryTime":650}
{"level":"ERROR","timestamp":"2025-12-07T14:25:19.131Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:19.132Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":2,"retryTime":1482}
{"level":"ERROR","timestamp":"2025-12-07T14:25:20.615Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:20.616Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":3,"retryTime":2586}
{"level":"ERROR","timestamp":"2025-12-07T14:25:23.208Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:23.208Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":4,"retryTime":5512}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.723Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.723Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":5,"retryTime":10562}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.723Z","logger":"kafkajs","message":"[Consumer] Crash: KafkaJSNumberOfRetriesExceeded: Connection error: connect ECONNREFUSED 127.0.0.1:9092","groupId":"news-agent-group","retryCount":5,"stack":"KafkaJSNonRetriableError\n  Caused by: KafkaJSConnectionError: Connection error: connect ECONNREFUSED 127.0.0.1:9092\n    at Socket.onError (/home/it/apps/thesis-report/backend/news-agent/node_modules/kafkajs/src/network/connection.js:210:23)\n    at Socket.emit (node:events:508:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)"}
{"level":"INFO","timestamp":"2025-12-07T14:25:28.723Z","logger":"kafkajs","message":"[Consumer] Stopped","groupId":"news-agent-group"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.723Z","logger":"kafkajs","message":"[Consumer] Restarting the consumer in 10562ms","retryCount":5,"retryTime":10562,"groupId":"news-agent-group"}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   {"level":"ERROR","timestamp":"2025-12-07T14:15:14.545Z","logger":"kafkajs","message":"[Connection] Response Heartbeat(key: 12, version: 3)","broker":"localhost:9092","clientId":"news-agent","error":"The group is rebalancing, so a rejoin is needed","correlationId":20,"size":10}
{"level":"WARN","timestamp":"2025-12-07T14:15:14.546Z","logger":"kafkajs","message":"[Runner] The group is rebalancing, re-joining","groupId":"news-agent-group","memberId":"news-agent-cdebd3db-b506-432a-9d76-8aba35a64540","error":"The group is rebalancing, so a rejoin is needed"}
{"level":"INFO","timestamp":"2025-12-07T14:15:14.632Z","logger":"kafkajs","message":"[ConsumerGroup] Consumer has joined the group","groupId":"news-agent-group","memberId":"news-agent-cdebd3db-b506-432a-9d76-8aba35a64540","leaderId":"news-agent-cdebd3db-b506-432a-9d76-8aba35a64540","isLeader":true,"memberAssignment":{"agent.tasks":[2]},"groupProtocol":"RoundRobinAssigner","duration":86}
[2025-12-07T14:17:33.712Z] ðŸ“¥ Processing task {
  "taskId": "1a738686-d472-4b02-8db6-634c55cb0d5b",
  "action": "analyze_watchlist",
  "agentType": "investment"
}
[2025-12-07T14:19:06.152Z] ðŸ“¥ Processing task {
  "taskId": "bf040d22-d7ce-46f5-8163-0ced73194c97",
  "action": "analyze_portfolio",
  "agentType": "investment"
}
{"level":"ERROR","timestamp":"2025-12-07T14:25:17.476Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:17.477Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":0,"retryTime":345}
{"level":"ERROR","timestamp":"2025-12-07T14:25:17.823Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:17.824Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":1,"retryTime":672}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.502Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:18.502Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":2,"retryTime":1478}
{"level":"ERROR","timestamp":"2025-12-07T14:25:19.984Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:19.984Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":3,"retryTime":3108}
{"level":"ERROR","timestamp":"2025-12-07T14:25:23.110Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:23.110Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":4,"retryTime":5222}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.344Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.344Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":5,"retryTime":9326}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.349Z","logger":"kafkajs","message":"[Consumer] Crash: KafkaJSNonRetriableError: Connection error: connect ECONNREFUSED 127.0.0.1:9092","groupId":"news-agent-group","stack":"KafkaJSNonRetriableError: Connection error: connect ECONNREFUSED 127.0.0.1:9092\n    at /home/it/apps/thesis-report/backend/news-agent/node_modules/kafkajs/src/retry/index.js:55:18\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.351Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"INFO","timestamp":"2025-12-07T14:25:28.351Z","logger":"kafkajs","message":"[Consumer] Stopped","groupId":"news-agent-group"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.351Z","logger":"kafkajs","message":"[Consumer] Restarting the consumer in 300ms","retryTime":300,"groupId":"news-agent-group"}
{"level":"INFO","timestamp":"2025-12-07T14:25:28.652Z","logger":"kafkajs","message":"[Consumer] Starting","groupId":"news-agent-group"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.655Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.655Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":0,"retryTime":279}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.935Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:28.936Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":1,"retryTime":618}
{"level":"ERROR","timestamp":"2025-12-07T14:25:29.556Z","logger":"kafkajs","message":"[Connection] Connection error: connect ECONNREFUSED 127.0.0.1:9092","broker":"localhost:9092","clientId":"news-agent","stack":"Error: connect ECONNREFUSED 127.0.0.1:9092\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)"}
{"level":"ERROR","timestamp":"2025-12-07T14:25:29.556Z","logger":"kafkajs","message":"[BrokerPool] Failed to connect to seed broker, trying another broker from the list: Connection error: connect ECONNREFUSED 127.0.0.1:9092","retryCount":2,"retryTime":1418}
